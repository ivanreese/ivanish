<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="format-detection" content="telephone=no">
<link rel="icon" sizes="192x192" href="apple-touch-icon.png"><!--Android-->
<link rel="icon" href="/assets/favicon-16x16.png" sizes="16x16">
<link rel="icon" href="/assets/favicon-48x48.png" sizes="48x48">
<link rel="icon" href="/assets/favicon-64x64.png" sizes="64x64">
<link rel="icon" href="/assets/favicon-192x192.png" sizes="192x192">
<link rel="icon" href="/assets/favicon-32x32.png" sizes="32x32"><!-- Must come last -->
<style>
@font-face {
  font-family: "sofia pro light";
  src: url("/assets/sofia-pro-light.woff") format("woff");
  font-weight: normal;
  font-style: normal;
}
</style>
<link rel="stylesheet" href="/styles.css">
<script>
window.ready = function(fn) {
  if (document.readyState == "loading") {
    document.addEventListener("DOMContentLoaded", fn);
  } else {
    fn();
  }
  return fn; // pass-through
}
</script>
<script defer src="/scripts.js"></script>
</head>
<body>


<title class="hide">Starfield</title>

<style>
html, body {
  width: 100%;
  height: 100%;
  background: hsl(113, 0%, 4%);
  overflow:hidden;
}
div {
  width: 100%; height: 100%;
  background-position: center center;
  background-size: contain;
}
</style>
<script src="http://ivanreese.s3.amazonaws.com/brain-scrubber/hammer.min.js"></script>

<script>
  window.ready(function(){
    var body = document.body;
    var seqs = [23, 25, 25, 33, 72];
    var count = 0;
    
    for (var s = 0; s < seqs.length; s++) {
      for (var i = 1; i <= seqs[s]; i++) {

        var img = i < 10 ? "0" + i : "" + i;
        var elm = document.createElement("div")

        elm.setAttribute("id", "img"+count);
        count++;

        elm.style.backgroundImage = 'url(http://ivanreese.s3.amazonaws.com/brain-scrubber/assets/'+s+'/'+img+'.jpg)';
        elm.style.display = "none";

        body.appendChild(elm)
      }
    }
    
    var dragging = false;
    var start = 0;
    var vel = 0;

    var pos = 0;
    var frame = 0;
    var speed = 0;
    var last = -1;
    var cur;

    Hammer(body).on("dragstart", function() {
      dragging = true;
      start = vel;
    });

    Hammer(body).on("drag", function(e) {
      vel = start + -2*e.gesture.deltaX/body.clientWidth;
    });
    
    Hammer(body).on("dragend", function() {
      dragging = false;
    });
    
    document.ontouchmove = function(event){
      event.preventDefault();
    }
    
    function animate() {
      if (!dragging) {
        vel /= 1.03;
        if (Math.abs(vel) < .03)
          vel = 0;
      }

      pos += vel;

      pos = pos % count;
      while (pos < 0) pos += count;
      frame = Math.floor(pos);

      if (frame != last) {
        last = frame;
        if (cur) cur.style.display = "none";
        cur = document.getElementById("img" + frame);
        if (cur) cur.style.display = "block";
      }
      requestAnimationFrame(animate);
    };
    
    requestAnimationFrame(animate);
  });
</script>
